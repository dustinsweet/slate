# Request Formats

## Retrieve resources with the HTTP GET Method
> HTTP Request

```shell
curl "https://rest.tsheets.com/api/v1/users?per_page=5&usernames=frank%2Cfred"
  -H "Authorization: Bearer <TOKEN>"
```

```csharp
var client = new RestClient("https://rest.tsheets.com/api/v1/users?per_page=5&usernames=frank%2Cfred");
var request = new RestRequest(Method.GET);
request.AddHeader("Authorization", "Bearer <TOKEN>");
IRestResponse response = client.Execute(request);
```

```java
OkHttpClient client = new OkHttpClient();

Request request = new Request.Builder()
  .url("https://rest.tsheets.com/api/v1/users?per_page=5&usernames=frank%2Cfred")
  .get()
  .addHeader("Authorization", "Bearer <TOKEN>")
  .build();

Response response = client.newCall(request).execute();
```

```javascript
var request = require("request");

var options = { method: 'GET',
  url: 'https://rest.tsheets.com/api/v1/users',
  qs: { per_page: '5',
        usernames: 'frank,fred'
  },
  headers: 
   { Authorization: 'Bearer <TOKEN>' } };

request(options, function (error, response, body) {
  if (error) throw new Error(error);

  console.log(body);
});
```

```php
<?php

$request = new HttpRequest();
$request->setUrl('https://rest.tsheets.com/api/v1/users');
$request->setMethod(HTTP_METH_GET);

$request->setQueryData(array(
  'per_page' => '5',
  'usernames' => 'frank,fred'
));

$request->setHeaders(array(
  'Authorization' => 'Bearer <TOKEN>'
));

try {
  $response = $request->send();

  echo $response->getBody();
} catch (HttpException $ex) {
  echo $ex;
}
```

```ruby
require 'uri'
require 'net/http'

url = URI("https://rest.tsheets.com/api/v1/users?per_page=5&usernames=frank%2Cfred")

http = Net::HTTP.new(url.host, url.port)

request = Net::HTTP::Get.new(url)
request["Authorization"] = 'Bearer <TOKEN>'

response = http.request(request)
puts response.read_body
```

```python
import requests

url = "https://rest.tsheets.com/api/v1/users"

querystring = {
  "per_page":"5",
  "usernames":"frank,fred"
}

payload = ""
headers = {
    'Authorization': "Bearer <TOKEN>"
    }

response = requests.request("GET", url, data=payload, headers=headers, params=querystring)

print(response.text)
```

```go
package main

import (
  "fmt"
  "net/http"
  "io/ioutil"
)

func main() {

  url := "https://rest.tsheets.com/api/v1/users?per_page=5&usernames=frank%2Cfred"

  req, _ := http.NewRequest("GET", url, nil)

  req.Header.Add("Authorization", "Bearer <TOKEN>")

  res, _ := http.DefaultClient.Do(req)

  defer res.Body.Close()
  body, _ := ioutil.ReadAll(res.Body)

  fmt.Println(res)
  fmt.Println(string(body))

}
```
You can retrieve a representation of an object by sending an HTTP GET action to the resource's endpoint url. Filters can be specified for the request using a query string following the endpoint url. For example, you could GET a list of users, showing 5 per page and having the username 'frank' or 'fred' with the following:

## Create new resources with the HTTP POST Method
> Request Body

```json
{
  "data":
  [ 
    {
      "username": "wwallace",
      "first_name": "William",
      "last_name": "Wallace",
      "email": "wwallace@example.com"
    },
    {
      "username": "mcurie",
      "first_name": "Marie",
      "last_name": "Curie"
    }    
  ]
}
```
> HTTP Request

```shell
curl -X POST \
  https://rest.tsheets.com/api/v1/users \
  -H 'Authorization: Bearer <TOKEN>' \
  -H 'Content-Type: application/json' \
  -d '<REQUEST BODY>'
```

```csharp
var client = new RestClient("https://rest.tsheets.com/api/v1/users");
var request = new RestRequest(Method.POST);
request.AddHeader("Content-Type", "application/json");
request.AddHeader("Authorization", "Bearer <TOKEN>");
request.AddParameter("undefined", "<REQUEST BODY>", ParameterType.RequestBody);
IRestResponse response = client.Execute(request);
```

```java
OkHttpClient client = new OkHttpClient();

MediaType mediaType = MediaType.parse("application/json");
RequestBody body = RequestBody.create(mediaType, "<REQUEST BODY>");
Request request = new Request.Builder()
  .url("https://rest.tsheets.com/api/v1/users")
  .post(body)
  .addHeader("Authorization", "Bearer <TOKEN>")
  .addHeader("Content-Type", "application/json")
  .build();

Response response = client.newCall(request).execute();
```

```javascript
var request = require("request");

var options = { method: 'POST',
  url: 'https://rest.tsheets.com/api/v1/users',
  headers: 
   { 'Content-Type': 'application/json',
     Authorization: 'Bearer <TOKEN>' },
  body: '<REQUEST BODY>',
  json: true };

request(options, function (error, response, body) {
  if (error) throw new Error(error);

  console.log(body);
});
```

```php
<?php

$request = new HttpRequest();
$request->setUrl('https://rest.tsheets.com/api/v1/users');
$request->setMethod(HTTP_METH_POST);

$request->setHeaders(array(
  'Content-Type' => 'application/json',
  'Authorization' => 'Bearer <TOKEN>'
));

$request->setBody('<REQUEST BODY>');

try {
  $response = $request->send();

  echo $response->getBody();
} catch (HttpException $ex) {
  echo $ex;
}
```

```ruby
require 'uri'
require 'net/http'

url = URI("https://rest.tsheets.com/api/v1/users")

http = Net::HTTP.new(url.host, url.port)

request = Net::HTTP::Post.new(url)
request["Authorization"] = 'Bearer <TOKEN>'
request["Content-Type"] = 'application/json'
request.body = "<REQUEST BODY>"

response = http.request(request)
puts response.read_body
```

```python
import requests

url = "https://rest.tsheets.com/api/v1/users"

payload = "<REQUEST BODY>"
headers = {
    'Authorization': "Bearer <TOKEN>",
    'Content-Type': "application/json"
    }

response = requests.request("POST", url, data=payload, headers=headers)

print(response.text)
```

```go
package main

import (
  "fmt"
  "strings"
  "net/http"
  "io/ioutil"
)

func main() {

  url := "https://rest.tsheets.com/api/v1/users"

  payload := strings.NewReader("<REQUEST BODY>")

  req, _ := http.NewRequest("POST", url, payload)

  req.Header.Add("Authorization", "Bearer <TOKEN>")
  req.Header.Add("Content-Type", "application/json")

  res, _ := http.DefaultClient.Do(req)

  defer res.Body.Close()
  body, _ := ioutil.ReadAll(res.Body)

  fmt.Println(res)
  fmt.Println(string(body))

}
```
You can add a new object by sending an `HTTP POST` action to the resource's endpoint url. You must include a JSON representation of the object in your POST body, and the `Content-Type: application/json` header must be set in your request.

## Update existing resources with the HTTP PUT Method
> Request Body

```json
{
  "data": [
    {
      "id": 2385283,
      "email": "william_wallace@anymail.com"
    },
    {
      "username": "mcurie",
      "pay_rate": 50.0,
      "permissions":
      {
        "approve_timesheets": true    	
      }
    }
  ]
}
```
> HTTP Request

```shell
curl -X PUT \
  https://rest.tsheets.com/api/v1/users \
  -H 'Authorization: Bearer <TOKEN>' \
  -H 'Content-Type: application/json' \
  -d '<REQUEST BODY>'
```

```csharp
var client = new RestClient("https://rest.tsheets.com/api/v1/users");
var request = new RestRequest(Method.PUT);
request.AddHeader("Content-Type", "application/json");
request.AddHeader("Authorization", "Bearer <TOKEN>");
request.AddParameter("undefined", "<REQUEST BODY>", ParameterType.RequestBody);
IRestResponse response = client.Execute(request);
```

```java
OkHttpClient client = new OkHttpClient();

MediaType mediaType = MediaType.parse("application/json");
RequestBody body = RequestBody.create(mediaType, "<REQUEST BODY>");
Request request = new Request.Builder()
  .url("https://rest.tsheets.com/api/v1/users")
  .put(body)
  .addHeader("Authorization", "Bearer <TOKEN>")
  .addHeader("Content-Type", "application/json")
  .build();

Response response = client.newCall(request).execute();
```

```javascript
var request = require("request");

var options = { method: 'PUT',
  url: 'https://rest.tsheets.com/api/v1/users',
  headers: 
   { 'Content-Type': 'application/json',
      Authorization: 'Bearer <TOKEN>' },
  body: '<REQUEST BODY>',
  json: true };

request(options, function (error, response, body) {
  if (error) throw new Error(error);

  console.log(body);
});
```

```php
<?php

$request = new HttpRequest();
$request->setUrl('https://rest.tsheets.com/api/v1/users');
$request->setMethod(HTTP_METH_PUT);

$request->setHeaders(array(
  'Content-Type' => 'application/json',
  'Authorization' => 'Bearer <TOKEN>'
));

$request->setBody('<REQUEST BODY>');

try {
  $response = $request->send();

  echo $response->getBody();
} catch (HttpException $ex) {
  echo $ex;
}
```

```ruby
require 'uri'
require 'net/http'

url = URI("https://rest.tsheets.com/api/v1/users")

http = Net::HTTP.new(url.host, url.port)

request = Net::HTTP::Put.new(url)
request["Authorization"] = 'Bearer <TOKEN>'
request["Content-Type"] = 'application/json'
request.body = "<REQUEST BODY>"

response = http.request(request)
puts response.read_body
```

```python
import requests

url = "https://rest.tsheets.com/api/v1/users"

payload = "<REQUEST BODY>"
headers = {
    'Authorization': "Bearer <TOKEN>",
    'Content-Type': "application/json"
    }

response = requests.request("PUT", url, data=payload, headers=headers)

print(response.text)
```

```go
package main

import (
  "fmt"
  "strings"
  "net/http"
  "io/ioutil"
)

func main() {

  url := "https://rest.tsheets.com/api/v1/users"

  payload := strings.NewReader("<REQUEST BODY>")

  req, _ := http.NewRequest("PUT", url, payload)

  req.Header.Add("Authorization", "Bearer <TOKEN>")
  req.Header.Add("Content-Type", "application/json")

  res, _ := http.DefaultClient.Do(req)

  defer res.Body.Close()
  body, _ := ioutil.ReadAll(res.Body)

  fmt.Println(res)
  fmt.Println(string(body))

}
```
You can edit an existing object by sending an `HTTP PUT` action to the resource's endpoint url. You must include a JSON representation of the object's modified properties in your PUT body, and the `Content-Type: application/json` header must be set in your request. For example, you could PUT changes using the user's unique id and the properties and values that you would like changed:

## Delete resources with the HTTP DELETE Method
> HTTP Request

```shell
curl "https://rest.tsheets.com/api/v1/users?usernames=joni%2Cfrank"
  -X DELETE
  -H "Authorization: Bearer <TOKEN>"
```

```csharp
var client = new RestClient("https://rest.tsheets.com/api/v1/users?usernames=joni%2Cfrank");
var request = new RestRequest(Method.DELETE);
request.AddHeader("Authorization", "Bearer <TOKEN>");
IRestResponse response = client.Execute(request);
```

```java
OkHttpClient client = new OkHttpClient();

Request request = new Request.Builder()
  .url("https://rest.tsheets.com/api/v1/users?usernames=joni%2Cfrank")
  .get()
  .addHeader("Authorization", "Bearer <TOKEN>")
  .build();

Response response = client.newCall(request).execute();
```

```javascript
var request = require("request");

var options = { method: 'DELETE',
  url: 'https://rest.tsheets.com/api/v1/users',
  qs: { usernames: 'joni,frank'
  },
  headers: 
   { Authorization: 'Bearer <TOKEN>' } };

request(options, function (error, response, body) {
  if (error) throw new Error(error);

  console.log(body);
});
```

```php
<?php

$request = new HttpRequest();
$request->setUrl('https://rest.tsheets.com/api/v1/users');
$request->setMethod(HTTP_METH_DELETE);

$request->setQueryData(array(
  'usernames' => 'joni,frank'
));

$request->setHeaders(array(
  'Authorization' => 'Bearer <TOKEN>'
));

try {
  $response = $request->send();

  echo $response->getBody();
} catch (HttpException $ex) {
  echo $ex;
}
```

```ruby
require 'uri'
require 'net/http'

url = URI("https://rest.tsheets.com/api/v1/users?usernames=joni%2Cfrank")

http = Net::HTTP.new(url.host, url.port)

request = Net::HTTP::Delete.new(url)
request["Authorization"] = 'Bearer <TOKEN>'

response = http.request(request)
puts response.read_body
```

```python
import requests

url = "https://rest.tsheets.com/api/v1/users"

querystring = {
  "usernames":"joni,frank"
}

payload = ""
headers = {
    'Authorization': "Bearer <TOKEN>"
    }

response = requests.request("DELETE", url, data=payload, headers=headers, params=querystring)

print(response.text)
```

```go
package main

import (
  "fmt"
  "net/http"
  "io/ioutil"
)

func main() {

  url := "https://rest.tsheets.com/api/v1/users?usernames=joni%2Cfrank"

  req, _ := http.NewRequest("DELETE", url, nil)

  req.Header.Add("Authorization", "Bearer <TOKEN>")

  res, _ := http.DefaultClient.Do(req)

  defer res.Body.Close()
  body, _ := ioutil.ReadAll(res.Body)

  fmt.Println(res)
  fmt.Println(string(body))

}
```
You can delete an existing object by sending an `HTTP DELETE` action to the resource's endpoint url. An `HTTP DELETE` is similar to a GET, where all relevant parameters are passed as part of a query string. You must include an identifying id of some sort for the object you would like to delete as part of your parameters.

## Possible Response Status Codes

### 2xx response codes
All 2xx response codes indicate success for the action requested. Following are the most common 2xx response codes:

|          |               |
| -------: | :------------ |
| <code class="level200s">200 OK</code> | The request was successful and the response body contains the response for the action requested. Usually comes in response to a GET request. |
| <code class="level200s">201 Created</code> | The request was successful and the response body contains the response for the action requested. A _201_ indicates that changes may have been made on the server side to the object when the request was handled (e.g. a timesheet was split due to break settings). The caller should check the `supplemental_data` of the response to process any related changes. Usually comes in response to a POST (create) or PUT (update) request. |
| <code class="level200s">202 Accepted</code> | The request was successful and the response body contains the response for the action requested. A _202_ indicates that the details of the create request match an already existing, active object. Rather than create a duplicate object, a _202_ is returned along with the id of the original object. Usually comes in response to a POST (create) request. |

### 3xx response codes
All 3xx response codes indicate that you need to look elsewhere for your result. The response body will contain directions on where you should be redirected to.

### 4xx response codes
All 4xx response codes indicate failure for the action requested. Following are the most common 4xx response codes:

|          |               |
| -------: | :------------ |
| <code class="level400s">400 Bad Request</code> | There was something wrong with your request. |
| <code class="level400s">401 Unauthorized</code> | You don't have sufficient permission to perform the action you requested. |
| <code class="level400s">402 Billing not current</code> | Your account billing is not current, so access was denied. |
| <code class="level400s">405 Method Not Allowed</code> | The action you are trying to perform is not allowed. |
| <code class="level400s">406 Not Acceptable</code> | The data you have tried to create conflicts with existing data. |
| <code class="level400s">409 Conflict</code> | The data you have tried to modify conflicts with existing data. |
| <code class="level400s">413 Max Items Exceeded</code> | The number of objects you are listing or editing or adding is too large. |
| <code class="level400s">417 Expectation Failed</code> | Your request was missing required parameters or your request was somehow otherwise malformed. |
| <code class="level400s">429 Too Many Requests</code> | You have sent too many requests to the API in too short a time. You'll have to try your requests again later. |

### 5xx response codes
All 5xx response codes indicate a server error or exceptional condition on the TSheets side. Following are the most common 5xx response codes:

|          |               |
| -------: | :------------ |
| <code class="level500s">500 Internal Server Error</code> | There was an unspecified error on the TSheets side. Try your request again in a moment; if you receive the same error then wait a few minutes before repeating it, as we are probably working to correct it. If you continue to receive the error after several hours, contact us to report a bug. |
| <code class="level500s">501 Method not implemented</code> | This method is not implemented for this object. It may be in the future. |
| <code class="level500s">503 (Various messages)</code> | A _503_ response code indicates that the service is temporarily unavailable. Wait a few minutes for the condition to clear, and try again. |

## Response Formats

<%= partial "includes/Overview/Examples/response_format.tmpl.erb" %>

TSheets returns resource representations as JSON, unless an exception occurs. Each JSON response object will contain the response data underneath an object property labeled 'results'. 

For GET requests, in the response body there will also be a boolean with the name, "more". If true, it means that there is another page of objects that can be retrieved. Otherwise _false_ will be the value. 

If the resource object references any other objects via an id (i.e. `group_id`), a corresponding JSON representation of that object will be contained in another top level property labeled `supplemental_data`.

## Exceptions

TSheets returns exceptions in the HTTP response body when something goes wrong. An exception has the following properties:

| Property    | Description |
| :---------- | :---------- |
| **code**    | The HTTP status code for the exception. |
| **message** | A descriptive message regarding the exception. |
